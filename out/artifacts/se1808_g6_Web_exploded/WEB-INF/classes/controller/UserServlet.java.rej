diff a/src/java/controller/UserServlet.java b/src/java/controller/UserServlet.java	(rejected hunks)
@@ -23,7 +23,7 @@
 @MultipartConfig
 @WebServlet(name = "UserServlet", urlPatterns = {"/user", "/user/update", "/user/details", "/user/new"})
 public class UserServlet extends HttpServlet {
-
+    
     protected void processRequest(HttpServletRequest request, HttpServletResponse response)
             throws ServletException, IOException {
         response.setContentType("text/html;charset=UTF-8");
@@ -40,61 +40,60 @@
             out.println("</html>");
         }
     }
-
+    
     UserDAO userDAO = new UserDAO();
     AvatarHandler avatarHandler = new AvatarHandler();
     private final int rowPerPage = 6;
-
+    
     private String getWorkingDir() {
         String directory = getServletContext().getRealPath("") + "";
         return directory.replace("\\build\\web\\", "\\web\\");
     }
-
-    void refreshSession(HttpSession session, User user) {
-        session.setAttribute("user", user);
-    }
-
+    
     @Override
     protected void doGet(HttpServletRequest request, HttpServletResponse response)
             throws ServletException, IOException {
         doPost(request, response);
-
+        
     }
-
+    
     @Override
     protected void doPost(HttpServletRequest request, HttpServletResponse response)
             throws ServletException, IOException {
         HttpSession session = request.getSession();
         User user = (User) session.getAttribute("user");
-        if (user != null) {
-            refreshSession(session, userDAO.getUserById(user.getId()));
-        }
-        /*HttpSession session = request.getSession();
-        User user = (User) session.getAttribute("user");
         if (user == null) {
             response.sendRedirect("login.jsp");
-        } else if (user.getRole() != 0) {
-            response.sendRedirect("home");
         } else {
-            refreshSession(request);*/
-        String action = request.getServletPath();
-        switch (action) {
-            case "/user":
-                viewUserList(request, response);
-                break;
-            case "/user/update":
-                updateUser(request, response);
-                break;
-            case "/user/details":
-                viewUserDetails(request, response);
-                break;
-            case "/user/new":
-                newUser(request, response);
-                break;
+            User u = userDAO.getUserById(user.getId());
+            if (u != null && u.getEmail() != null) {
+                session.setAttribute("user", u);
+                if (user.getRole() != 0) {
+                    response.sendRedirect("home");
+                } else {
+                    String action = request.getServletPath();
+                    switch (action) {
+                        case "/user":
+                            viewUserList(request, response);
+                            break;
+                        case "/user/update":
+                            updateUser(request, response);
+                            break;
+                        case "/user/details":
+                            viewUserDetails(request, response);
+                            break;
+                        case "/user/new":
+                            newUser(request, response);
+                            break;
+                    }
+                }
+            } else {
+                response.sendRedirect("login.jsp");
+            }
         }
-
+        
     }
-
+    
     private ArrayList<String> allSortOptions() {
         ArrayList<String> list = new ArrayList<>();
         list.add("Name");
@@ -316,7 +315,7 @@
             request.getRequestDispatcher("/WEB-INF/views/user/userdetails.jsp").forward(request, response);
         }
     }
-
+    
     private void updateUser(HttpServletRequest request, HttpServletResponse response)
             throws IOException, ServletException {
         switch (request.getParameter("action")) {
@@ -328,23 +327,23 @@
                 break;
         }
     }
-
+    
     private void viewUserDetails(HttpServletRequest request, HttpServletResponse response)
             throws IOException, ServletException {
         int userId = Integer.parseInt(request.getParameter("userId"));
         User user = userDAO.getUserById(userId);
-
+        
         request.setAttribute("user", user);
         request.setAttribute("roleList", getRoleList());
         request.getRequestDispatcher("/WEB-INF/views/user/userdetails.jsp").forward(request, response);
     }
-
+    
     private void goToPage(HttpServletRequest request, HttpServletResponse response)
             throws IOException, ServletException {
         request.setAttribute("roleList", getRoleList());
         request.getRequestDispatcher("/WEB-INF/views/user/newuser.jsp").forward(request, response);
     }
-
+    
     private void addUser(HttpServletRequest request, HttpServletResponse response)
             throws IOException, ServletException {
         boolean successful = true;
